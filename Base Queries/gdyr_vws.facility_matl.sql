SELECT
    FM.ORIG_SYS_ID,
    FM.FACILITY_ID,
    FM.MATL_ID,
    FM.EFF_DT,
    FM.EXP_DT,
    FM.SRC_SYS_ID,
    FM.EDW_JOB_ID,
    FM.SBU_ID,
    FM.PRCH_GRP_ID,
    FM.LOAD_GRP_ID,
    FM.MRP_TYPE_ID,
    FM.XPT_GRP_ID,
    FM.MRP_CNTRL_ID,
    FM.MRP_GRP_ID,
    FM.DEL_IND,
    FM.IMP_CMDTY_ID,
    FM.PRCU_TYPE_ID,
    FM.MATL_MAINT_STA_ID,
    FM.PERD_TYPE_ID,
    FM.EST_WKLY_PROD_QTY,
    FM.DAYS_TO_DELIV,
    FM.DAYS_TO_GOODS_RCPT,
    FM.DAYS_TO_RPLN,
    FM.LOT_SZ_PERD_ID,
    FM.MAX_STK_LVL_QTY,
    FM.MAX_RORD_LOT_SZ_QTY,
    FM.MIN_RORD_LOT_SZ_QTY,
    FM.RORD_PT_QTY,
    FM.RND_RORD_QTY,
    FM.FXD_RORD_LOT_SZ_QTY,
    FM.APO_ICD,
    FM.STOR_LOC_ID,
    FM.VAL_CTGY_CD,
    FM.ABC_CONS_ICD,
    FM.REPL_MATL_ID,
    FM.EFF_OUT_DT,
    FM.QUAL_INSP_IND,
    FM.IN_TRANSF_STK_QTY,
    FM.CAP_PLN_BASE_QTY,
    FM.AUTO_PRCH_ORD_ALLOW_IND,
    FM.RGN_ORIG_ID,
    FM.PROFT_CNTR_CD,
    FM.IN_TRANSIT_STK_QTY,
    FM.REPETITIVE_MFG_ALLOW_IND,
    FM.CONS_MODE_CD,
    FM.BACKWARD_CONS_PERD_WRK_DY_QTY,
    FM.FORWARD_CONS_PERD_WRK_DY_QTY,
    FM.SAFE_WRK_DY_QTY,
    FM.CURR_PERD_FISCAL_YR,
    FM.CURR_FISCAL_PERD_IND,
    FM.SAFE_STK_QTY,
    FM.CNTR_WHSE_IND,
    FM.CRTCL_PART_IND,
    FM.MATL_ISSUE_UOM_CD,
    FM.SCHEDULER_CD,
    FM.AVAIL_CHK_GRP_CD,
    FM.PRCU_COST_TYP_CD,
    FM.PLN_STRAT_GRP_CD,
    FM.TASK_LIST_TYP_CD,
    FM.PROD_VER_CST_CD,
    FM.MIN_SAFE_STK_QTY,
    FM.SVC_LVL_PCT,
    FM.SPCL_PRCU_TYP_CD,
    FM.PLANT_SPEC_MATL_STA_CD,
    FM.PLANT_SPEC_MATL_STA_VLD_DT,
    FM.ASSMB_SCRAP_PCT,
    FM.QUOTA_ARRNG_USE_CD,
    FM.ALT_BOM_SLCT_MTHD_CD,
    FM.INDIV_COLLCT_RQR_CD,
    FM.RQR_GRP_CD,
    FM.CMPNT_SCRAP_PCT,
    FM.MFG_PRFL_CD,
    FM.ISS_STOR_LOC_ID,
    FM.MIX_MRP_CD,
    FM.OE_YIELD_PCT,
    FM.NSDS_CD,
    FM.MATL_ORIG_CNTRY_NAME_CD,
    FM.MAINT_SRC_LIST_IND,
    FM.TAKT_TM_DY_QTY,
    FM.CW_PUSH_IND,
    FM.NET_WT

FROM GDYR_VWS.FACILITY_MATL FM

    INNER JOIN GDYR_BI_VWS.NAT_MATL_HIER_DESCR_EN_CURR MATL
        ON MATL.MATL_ID = FM.MATL_ID
        AND MATL.PBU_NBR IN ('01', '03', '04', '05', '07', '08', '09')
        AND MATL.SUPER_BRAND_ID IN ('01', '02', '03', '05')

WHERE
    FM.ORIG_SYS_ID = 2
    AND FM.EXP_DT >= CAST(ADD_MONTHS(CURRENT_DATE, -24) - EXTRACT(DAY FROM ADD_MONTHS(CURRENT_DATE, -24)) AS DATE)

ORDER BY
    FM.FACILITY_ID,
    FM.MATL_ID,
    FM.EXP_DT